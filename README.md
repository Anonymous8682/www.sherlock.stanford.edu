# Sherlock tangly web of webs

The Sherlock web presence is made of 3 components, each living in its own
branch of the [stanford-rc/sherlock](https://github.com/stanford-rc/sherlock) GitHub repository:
  1. a landing page (branch: [`web_landing`](https://github.com/stanford-rc/sherlock/tree/web_landing))
  2. a theme for the documentation pages (branch: [`web_theme`](https://github.com/stanford-rc/sherlock/tree/web_theme))
  3. documentation pages generated from Markdown by [MkDocs](http://mkdocs.org)
     (branch: [`web_docs`](https://github.com/stanford-rc/sherlock/tree/web_docs))

Each of those components has two parts:
  * a 'source' directory, where modifications can be done, 
  * a 'build' directory, where final output is generated by a script

![webs](https://docs.google.com/drawings/d/1ja1TyamMKqiemhwW7ZJgdSbmD9wy7xGXhPkNxOEvPE4/pub?w=842&amp;h=715)
(<small>[edit the picture](https://docs.google.com/drawings/d/1ja1TyamMKqiemhwW7ZJgdSbmD9wy7xGXhPkNxOEvPE4/edit)</small>)


## Components

### Landing page 

The landing page is ultimately a single static HTML
`index.html` file, with a couple associated Javascript, CSS and images files.

It lives in the [`web_landing`
branch](https://github.com/stanford-rc/sherlock/tree/web_landing) of the
[Sherlock repository](https://github.com/stanford-rc/sherlock)

#### Modify 

The sources files are mostly:
  * content and structure: `index.html`
  * style: `less/shweb.less`

#### Build To build it: 

``` 
npm install 
gulp build 
``` 
This will generate the static content in `build/`

#### Deploy 

The contents of the `build/` directory will need to be pushed to
`src/` in the `shweb_docs` branch.


### Documentation theme 

The theme is a modified version of [Material for MkDocs](https://squidfunk.github.io/mkdocs-material). It generates a set of static HTML, JS and CSS files.

It lives in the [`web_theme` branch](https://github.com/stanford-rc/sherlock/tree/shweb_theme) of the
[Sherlock repository](https://github.com/stanford-rc/sherlock)

#### Modify 

Modify things in `src/`

#### Build 

To install dependencies: 
``` 
pip install -r requirements.txt 
yarn install
``` 

To build it: 
``` 
yarn run build 
```

#### Deploy 

The contents of the **FIXME** `build/` directory will need to be pushed to `src/theme` in the `web_docs` branch



### Documentation pages 

The documentation pages are served by [MkDocs](https://mkdocs.org), which transform easy-to-edit Markdown files to
HTML contents.

They live in the [`web_docs` branch](https://github.com/stanford-rc/sherlock/tree/web_docs) of the [Sherlock
repository](https://github.com/stanford-rc/sherlock)


#### Modify 

All the Markdown files live in `src/docs` and the MkDocs configuration (structure, plugins, site settings) are in `mkdocs.yml`

#### Build 

``` 
mkdocs build 
```

#### Deploy 

The generated static pages will need to be pushed to the `gh-pages` branch of the Sherlock repository, to be served by GitHub 

``` 
mkdocs gh-deploy
```
   

## Automation 
:construction:

Each branch contains a [Travis](https://travisci.com) configuration file, that will:
  1. build the branch contents on a successfull commit
  2. deploy the generated contents

So for instance, a commit in the landing page branch will generate a Travis build of the landing page, and the resulting HTML contents will be pushed and commited to the `src/` directory in the `sh_docs` branch.

This `sh_docs` branch commit will in turn generate a Travis build of the MkDocs pages, which will get pushed to the `gh-pages` branch for final publication.
